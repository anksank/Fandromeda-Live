var app=app||angular.module("FandromedaV2",[]);app.service("asynNetworkService",function($http,$q){return({get:get,post:post});function get(urls){var resp={};var deferred=$q.defer();var urlCalls=[];urls=angular.isArray(urls)?urls:[{url:urls,key:"default"}];angular.forEach(urls,function(url){urlCalls.push($http({method:"get",url:url.url,params:url.params||{}}))});$q.all(urlCalls).then(function(results){var resp={};angular.forEach(urls,function(v,i){resp[v.key]=results[i].data});deferred.resolve(resp)},function(errors){deferred.reject(errors);console.warn(errors.config.url,errors.status,errors.statusText)},function(updates){angular.forEach(urls,function(v,i){resp[v.key]=updates[i].data});deferred.update(resp)});return deferred.promise}function post(url,data){var resp={};var deferred=$q.defer();var request=$http({method:"post",url:url,data:data});request.then(function(results){resp=results.data;deferred.resolve(resp)},function(errors){deferred.reject(errors)},function(updates){resp=updates.data;deferred.update(resp)});return deferred.promise}});app.service("dataHelper",function(){var skillMap={"1":"d","2":"c","3":"b","4":"a","5":"F","6":"M","7":"D","8":"G","12":"W","13":"M"};var ppMap={"0":{batting_power:"h",bowling_power:"i"},"1":{batting_power:"h",bowling_power:"i"},"2":{batting_power:"h",bowling_power:"i"},"3":{batting_power:"",bowling_power:"j"},"4":{batting_power:"",bowling_power:String.fromCharCode(9054)},"5":{batting_power:"h",bowling_power:"i"},"10":{batting_power:"h",bowling_power:"i"},"11":{batting_power:"h",bowling_power:"i"},"12":{batting_power:"h",bowling_power:"i"},"13":{batting_power:"",bowling_power:"j"},"15":{batting_power:"h",bowling_power:"i"}};var eSkillOrder={"0":[4,1,2,3],"1":[4,1,2,3],"2":[4,1,2,3],"3":[8,7,6,5],"4":[13,12],"5":[4,1,2,3],"10":[4,1,2,3],"11":[4,1,2,3],"12":[4,1,2,3],"13":[8,7,6,5],"15":[4,1,2,3]};var champClassicMenu=[{id:1,active:1,menu_name:"Leaderboard",url:"/v2/champ/standings_classic/<CHAMP_ID>"},{id:2,active:1,menu_name:"Live",url:"/v2/champ/classic_live/<CHAMP_ID>"},{id:3,active:1,menu_name:"Squad",onclick:"",url:"#"},{id:4,active:1,menu_name:"Points",onclick:"",url:"#"},{id:5,active:1,menu_name:"Subs",onclick:"",url:"#"},{id:6,active:0,menu_name:"Guide",url:"/v2/default/game_guide_t20_new/"},{id:7,active:1,menu_name:"Schedule",url:"/v2/champ/schedule/<CHAMP_ID>",new_tab:true}];var champPpsMenu=[{id:1,active:1,menu_name:"Leaderboard",url:"/v2/champ/standings_pps/<CHAMP_ID>"},{id:2,active:1,menu_name:"Live",url:"/v2/champ/pps_live/<CHAMP_ID>"},{id:3,active:1,menu_name:"Squad",onclick:"",url:"#"},{id:4,active:1,menu_name:"Points",onclick:"",url:"#"},{id:5,active:1,menu_name:"Subs",onclick:"",url:"#"},{id:6,active:0,menu_name:"Guide",url:"/v2/default/game_guide_t20_new/"},{id:7,active:1,menu_name:"Schedule",url:"/v2/champ/schedule/<CHAMP_ID>",new_tab:true}];return({changeUnits:changeUnits,skillMap:skillMap,ppMap:ppMap,eSkillOrder:eSkillOrder,champClassicMenu:champClassicMenu,champPpsMenu:champPpsMenu,strToDate:strToDate,addCommas:addCommas,getParameterByName:getParameterByName,getShareDtFormat:getShareDtFormat,arrayToMap:arrayToMap,sortArrayByDate:sortArrayByDate,getMobileOperatingSystem:getMobileOperatingSystem,getColorHash:getColorHash});function strToDate(datestr){var d=datestr.split(" ");var tmp="";tmp=d[1].split(":");d=d[0].split("-");var dt=new Date(d[0],d[1]-1,d[2],tmp[0],tmp[1],tmp[2].split(".")[0],0);return dt}function changeUnits(num,k){var len=(num+"").length;if(len>3&&len<=5){if(num%1000==0){num=parseFloat(num/1000)}else{num=parseFloat(num/1000).toFixed(1)}num=addCommas(num)+"K"}else{if(len>5){if(k==undefined||!k){if(num%100000==0){num=parseFloat(num/100000)}else{num=parseFloat(num/100000).toFixed(1)}num=addCommas(num)+"L"}else{if(num%1000==0){num=parseFloat(num/1000)}else{num=parseFloat(num/1000).toFixed(1)}num=addCommas(num)+"K"}}else{num=addCommas(num)}}return num}function addCommas(val){isNeg=false;if(val<0){val=val*-1;isNeg=true}var x=parseFloat(val);if(isNaN(val)){return val}x=x.toString();var afterPoint="";if(x.indexOf(".")>0){afterPoint=x.substring(x.indexOf("."),x.length)}x=Math.floor(x);x=x.toString();var lastThree=x.substring(x.length-3);var otherNumbers=x.substring(0,x.length-3);if(otherNumbers!=""){lastThree=","+lastThree}var res=otherNumbers.replace(/\B(?=(\d{2})+(?!\d))/g,",")+lastThree+afterPoint;if(isNeg){return"-"+res}return res}function getParameterByName(name,url){if(!url){url=window.location.href}name=name.replace(/[\[\]]/g,"\\$&");var regex=new RegExp("[?&]"+name+"(=([^&#]*)|&|#|$)"),results=regex.exec(url);if(!results){return null}if(!results[2]){return""}return decodeURIComponent(results[2].replace(/\+/g," "))}function arrayToMap(arr,key,addToArr){addToArr=typeof(addToArr)=="boolean"?addToArr:false;return arr.reduce(function(map,obj){if(addToArr){if(map[obj[key]]==undefined){map[obj[key]]=[]}map[obj[key]].push(obj)}else{map[obj[key]]=obj}return map},{})}function sortArrayByDate(arr,key,order){order=(order===1||order===-1)?order:1;return arr.sort(function(a,b){if(order==1){return strToDate(a[key]).getTime()-strToDate(b[key]).getTime()}else{return strToDate(b[key]).getTime()-strToDate(a[key]).getTime()}})}function getMobileOperatingSystem(){var userAgent=navigator.userAgent||navigator.vendor||window.opera;if(/windows phone/i.test(userAgent)){return"Windows Phone"}if(/android/i.test(userAgent)){return"Android"}if(/iPad|iPhone|iPod/.test(userAgent)&&!window.MSStream){return"iOS"}return"unknown"}function getColorHash(c,put_hash){if(!put_hash||c==undefined){return c}return c.search("#")>-1?c:("#"+c)}});app.directive("customLoginValidator",function(){var EMAIL_REGEXP=/(^([a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+[\.]{1}[a-zA-Z]{2,6}){1}$)/i;var USERNAME_REGEXP=/^(?=.*[a-zA-Z])[a-zA-Z0-9_]+$/i;var USERNAME_UNDERSCORE_REGEXP=/^(?![_])[a-zA-Z0-9_]+$/i;return{require:"?ngModel",link:function(scope,elm,attrs,ctrl){if(ctrl){ctrl.$validators.email=function(modelValue){return ctrl.$isEmpty(modelValue)||EMAIL_REGEXP.test(modelValue)||USERNAME_REGEXP.test(modelValue)||USERNAME_UNDERSCORE_REGEXP.test(modelValue)}}}}});app.directive("customValidatorPhone",function(){var NUMBER_REGEXP=/^([0-9]\d{9})$/;return{require:"?ngModel",link:function(scope,elm,attrs,ctrl){if(ctrl){ctrl.$validators.phone_number=function(modelValue){return ctrl.$isEmpty(modelValue)||NUMBER_REGEXP.test(modelValue)}}}}});app.directive("siteDomainGate",function(){return{link:function(scope,elm,attrs,ctrl){try{try{var blocked_site_keys=angular.element(elm).attr("data-block-site-key").split(",").map(Number)}catch(e){var blocked_site_keys=[]}try{var allowed_site_keys=angular.element(elm).attr("data-allow-site-key").split(",").map(Number)}catch(e){var allowed_site_keys=[]}if(blocked_site_keys.length&&blocked_site_keys.indexOf(site_domain_key)>-1){elm.hide()}else{if(allowed_site_keys.length&&allowed_site_keys.indexOf(site_domain_key)==-1){elm.hide()}}}catch(e){console.warn(e)}}}});app.directive("customValidatorEmailPhone",function(){var EMAIL_REGEXP=/(^([a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+[\.]{1}[a-zA-Z]{2,6}){1}$)/i;var NUMBER_REGEXP=/^([0-9]\d{9})$/;return{require:"?ngModel",link:function(scope,elm,attrs,ctrl){if(ctrl){ctrl.$validators.email=function(modelValue){if(!isNaN(Number(modelValue))){return true}return ctrl.$isEmpty(modelValue)||EMAIL_REGEXP.test(modelValue)}}if(ctrl){ctrl.$validators.phone_number=function(modelValue){if(isNaN(Number(modelValue))){return true}return ctrl.$isEmpty(modelValue)||NUMBER_REGEXP.test(modelValue)}}}}});app.directive("customEmailValidator",function(){var EMAIL_REGEXP=/(^([a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+[\.]{1}[a-zA-Z]{2,6}){1}$)/i;return{require:"?ngModel",link:function(scope,elm,attrs,ctrl){if(ctrl){ctrl.$validators.email=function(modelValue){return ctrl.$isEmpty(modelValue)||EMAIL_REGEXP.test(modelValue)}}}}});app.directive("customUsernameValidator",function(){var USERNAME_REGEXP=/^(?=.*[a-zA-Z])[a-zA-Z0-9_]+$/i;var USERNAME_UNDERSCORE_REGEXP=/^(?![_])[a-zA-Z0-9_]+$/i;return{require:"?ngModel",link:function(scope,elm,attrs,ctrl){if(ctrl){ctrl.$validators.username=function(modelValue){return ctrl.$isEmpty(modelValue)||USERNAME_REGEXP.test(modelValue)};ctrl.$validators.usernameunderscore=function(modelValue){return ctrl.$isEmpty(modelValue)||USERNAME_UNDERSCORE_REGEXP.test(modelValue)}}}}});app.directive("customNameValidator",function(){var NAME_REGEXP=/^[a-zA-Z0-9_\s]+$/i;return{require:"?ngModel",link:function(scope,elm,attrs,ctrl){if(ctrl){ctrl.$validators.name=function(modelValue){return ctrl.$isEmpty(modelValue)||NAME_REGEXP.test(modelValue)}}}}});app.factory("httpInterceptor",["$q","$rootScope",function($q,$rootScope){var loadingCount=0;return{request:function(config){if(++loadingCount===1){$rootScope.$broadcast("loading:progress")}return config||$q.when(config)},response:function(response){if(--loadingCount===0){$rootScope.$broadcast("loading:finish")}return response||$q.when(response)},responseError:function(response){if(--loadingCount===0){$rootScope.$broadcast("loading:finish")}$rootScope.$broadcast("loading:error");return $q.reject(response)}}}]).config(["$httpProvider",function($httpProvider){$httpProvider.interceptors.push("httpInterceptor")}]);app.directive("siteBackMob",function($rootScope){return{restrict:"E",template:'<span class="symbol head-back">&#x2347;</span>',scope:{back:"@back"},link:function(scope,element,attrs,rootScope){$(element[0]).on("click",function(){if(document.referrer!=""){window.location=document.referrer}else{history.back()}})}}});app.directive("siteBackWeb",function($rootScope){return{restrict:"E",template:'<i class="symbol">&#x2347;</i>',scope:{back:"@back"},link:function(scope,element,attrs,rootScope){$(element[0]).on("click",function(){if(document.referrer!=""){window.location=document.referrer}else{history.back()}})}}});app.config(function($sceDelegateProvider){$sceDelegateProvider.resourceUrlWhitelist(["self","https://s3.ap-south-1.amazonaws.com/**"]);$sceDelegateProvider.resourceUrlBlacklist([])});function getDdate(d){d=d.split(" ");day=parseFloat(d[0]);if((day>=4&&day<=20)||(day>=24&&day<=30)){suffix="TH"}else{suffix=["ST","ND","RD"][(day%10)-1]}d[0]=d[0]+suffix;return d.join(" ")}function getShareDtFormat(dtm,b,f,sec){if(dtm==undefined){return"-"}var dt=new Date(strToDate(dtm));var suffix="";day=(dt.getDate());if((day>=4&&day<=20)||(day>=24&&day<=30)){suffix="th"}else{suffix=["st","nd","rd"][(day%10)-1]}var tdate=dt.getDate();var dtstr=dt.getMonthName(f)+" "+tdate+", ";if(!b){var dtstr=dt.getMonthName(f)+" "+tdate+" "+suffix;return dtstr}var hour=dt.getHours();var ap="am";if(hour>11){ap="pm"}if(hour>12){hour=hour-12}if(hour==0){hour=12}minu=dt.getMinutes();secs=dt.getSeconds();if(minu<10){minu="0"+minu}if(sec){if(secs<=9){dtstr+=" "+hour+":"+minu+":0"+secs+" "+ap+" "}else{dtstr+=" "+hour+":"+minu+":"+secs+" "+ap+" "}}else{dtstr+=" "+hour+":"+minu+""+ap+" "}return dtstr}function strToDate(datestr){try{var d=datestr.split(" ");var tmp="";tmp=d[1].split(":");d=d[0].split("-");var dt=new Date(d[0],d[1]-1,d[2],tmp[0],tmp[1],tmp[2].split(".")[0],0);return dt}catch(e){console.error(e,datestr)}}var months=function(){return{names:{0:"January",1:"February",2:"March",3:"April",4:"May",5:"June",6:"July",7:"August",8:"September",9:"October",10:"November",11:"December"},namesShort:{0:"Jan",1:"Feb",2:"Mar",3:"Apr",4:"May",5:"June",6:"July",7:"Aug",8:"Sep",9:"Oct",10:"Nov",11:"Dec"},getMonthName:function(m,f){var n="";if(f==undefined||!f){n=this.names}else{n=this.namesShort}if(m===undefined||m.toString().trim().length===0){return""}if(m<0||m>11){return""}else{return n[m]}}}}();Date.prototype.getMonthName=function(f){if(isNaN(this)){return NaN}return months.getMonthName(this.getMonth(),f)};function isValidDate(s){var dateFormat=/^\d{1,4}[\.|\/|-]\d{1,2}[\.|\/|-]\d{1,4}$/;if(dateFormat.test(s)){s=s.replace(/0*(\d*)/gi,"$1");var dateArray=s.split(/[\.|\/|-]/);dateArray[1]=dateArray[1]-1;if(dateArray[2].length<4){dateArray[2]=(parseInt(dateArray[2])<50)?2000+parseInt(dateArray[2]):1900+parseInt(dateArray[2])}var testDate=new Date(dateArray[2],dateArray[1],dateArray[0]);if(testDate.getDate()!=dateArray[0]||testDate.getMonth()!=dateArray[1]||testDate.getFullYear()!=dateArray[2]){return false}else{return true}}else{return false}}function dynamicSortMultiple(){function dynamicSort(property){var sortOrder=1;if(property[0]==="-"){sortOrder=-1;property=property.substr(1)}return function(a,b){var result=(a[property]<b[property])?-1:(a[property]>b[property])?1:0;return result*sortOrder}}var props=arguments;return function(obj1,obj2){var i=0,result=0,numberOfProperties=props.length;while(result===0&&i<numberOfProperties){result=dynamicSort(props[i])(obj1,obj2);i++}return result}};